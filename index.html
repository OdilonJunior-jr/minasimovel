<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="theme-color" content="#050608">
    <title>Minas Imóveis | Premium</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Montserrat:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        brand: {
                            gold: '#C6A87C', 
                            goldHover: '#B39467',
                            dark: '#050608', 
                            surface: '#121826',
                            border: 'rgba(255,255,255,0.08)',
                            text: '#E2E8F0',
                            whatsapp: '#25D366'
                        }
                    },
                    fontFamily: {
                        sans: ['"Lato"', 'sans-serif'],
                        display: ['"Montserrat"', 'sans-serif'],
                    },
                    boxShadow: {
                        'glow': '0 0 25px rgba(198, 168, 124, 0.10)',
                        'card': '0 10px 30px -5px rgba(0, 0, 0, 0.5)',
                    }
                }
            }
        }
    </script>

    <style>
        body { 
            background-color: #050608; 
            color: #E2E8F0; 
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        img { pointer-events: none; -webkit-user-drag: none; user-select: none; }

        /* --- MARCA D'ÁGUA GERAL --- */
        .watermark-overlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            pointer-events: none; z-index: 9999; overflow: hidden;
            display: flex; flex-wrap: wrap; align-content: flex-start; opacity: 0.03;
        }
        
        .watermark-item {
            width: 300px; height: 100px; display: flex; align-items: center; justify-content: center;
            transform: rotate(-45deg); font-family: 'Montserrat', sans-serif; font-weight: 900;
            color: #fff; text-transform: uppercase; font-size: 14px; letter-spacing: 2px; white-space: nowrap;
        }

        /* --- MARCA D'ÁGUA NAS FOTOS --- */
        .img-watermark {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-30deg);
            font-size: 1.5rem; font-weight: 900; color: rgba(255,255,255,0.15);
            text-transform: uppercase; white-space: nowrap; pointer-events: none; z-index: 10;
            border: 2px solid rgba(198, 168, 124, 0.2); padding: 8px 30px;
            font-family: 'Montserrat', sans-serif; letter-spacing: 4px; backdrop-filter: blur(1px);
        }
        @media (max-width: 768px) { .img-watermark { font-size: 1rem; padding: 5px 20px; border-width: 1px; } }

        /* --- INPUTS OTIMIZADOS --- */
        .input-padrao {
            width: 100%; height: 42px; background-color: #0c101a; color: #fff;
            border: 1px solid rgba(255,255,255,0.1); border-radius: 0.5rem;
            padding: 0 1rem; font-size: 13px; outline: none; transition: all 0.3s ease; appearance: none;
        }
        .input-padrao:focus { border-color: #C6A87C; background-color: #121826; }
        
        select.input-padrao {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23C6A87C' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat; background-position: right 0.8rem center; background-size: 1rem;
        }
        select option { background-color: #121826; color: #fff; padding: 10px; }

        /* --- DRAWER MOBILE --- */
        #mobile-menu-drawer { transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1); transform: translateX(100%); }
        #mobile-menu-drawer.open { transform: translateX(0); }
        
        .glass-panel { background: rgba(18, 24, 38, 0.8); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.08); }
        .fade-in { animation: fadeIn 0.6s ease-out forwards; opacity: 0; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        .gallery-thumb { opacity: 0.4; transition: all 0.2s; border: 1px solid transparent; }
        .gallery-thumb.active { opacity: 1; border-color: #C6A87C; transform: scale(1.05); }

        .mobile-sticky-bar {
            position: fixed; bottom: 0; left: 0; width: 100%; z-index: 50;
            background: rgba(12, 16, 26, 0.95); backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255,255,255,0.1); padding: 12px 20px;
            padding-bottom: calc(12px + env(safe-area-inset-bottom));
            transform: translateY(100%); transition: transform 0.3s ease;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.5);
        }
        .mobile-sticky-bar.visible { transform: translateY(0); }
        
        .btn-insta { 
            background: radial-gradient(circle at 30% 107%, #fdf497 0%, #fdf497 5%, #fd5949 45%, #d6249f 60%, #285AEB 90%); 
            color: white; border: none; display: flex; align-items: center; justify-content: center;
        }
        .btn-insta:hover { opacity: 0.9; transform: scale(1.05); }
    </style>
</head>
<body class="antialiased font-sans text-gray-300">

    <div class="watermark-overlay" id="watermark-grid"></div>

    <nav class="hidden lg:flex fixed w-full z-50 bg-[#050608]/90 border-b border-brand-border h-24 items-center justify-center backdrop-blur-md">
        <div class="max-w-7xl w-full px-8 flex justify-between items-center">
            <div class="h-20 w-auto cursor-pointer transition-transform hover:scale-105" onclick="app.router('home')">
                <img src="logo-minas.png" alt="Minas Imóveis" class="h-full w-auto object-contain" onerror="this.onerror=null; this.src='https://via.placeholder.com/300x150/C6A87C/000000?text=MINAS'">
            </div>
            <div class="flex items-center gap-8 font-display text-[11px] font-bold tracking-[0.15em] uppercase text-white">
                <button onclick="app.router('home')" class="hover:text-brand-gold transition-colors">Início</button>
                <button onclick="app.router('catalog')" class="hover:text-brand-gold transition-colors">Imóveis</button>
                <button onclick="app.router('about')" class="hover:text-brand-gold transition-colors">Sobre</button>
                <a href="https://wa.me/5534984408992" target="_blank" class="border border-brand-gold/50 text-brand-gold px-6 py-3 rounded hover:bg-brand-gold hover:text-black transition-all flex items-center gap-2">
                    <i data-lucide="plus" class="w-4 h-4"></i> Anunciar
                </a>
            </div>
        </div>
    </nav>

    <button onclick="toggleMobileMenu()" class="lg:hidden fixed top-6 right-6 z-50 text-white p-2.5 bg-black/40 rounded-full backdrop-blur-md border border-white/10 shadow-xl active:scale-90 transition-transform hover:bg-black/60">
        <i data-lucide="menu" class="w-7 h-7 text-brand-gold"></i>
    </button>
        
    <div id="mobile-menu-overlay" onclick="toggleMobileMenu()" class="fixed inset-0 bg-black/90 hidden opacity-0 backdrop-blur-sm z-[90]"></div>
    <div id="mobile-menu-drawer" class="fixed top-0 right-0 h-full w-[85%] max-w-[320px] bg-[#0c101a] border-l border-brand-border shadow-2xl flex flex-col z-[100] pt-safe">
        <div class="p-6 flex justify-between items-center border-b border-brand-border/50">
            <span class="text-brand-gold font-bold text-[10px] uppercase tracking-widest">Menu</span>
            <button onclick="toggleMobileMenu()" class="text-white"><i data-lucide="x" class="w-6 h-6"></i></button>
        </div>
        <div class="p-6 flex-grow space-y-6">
            <a href="https://wa.me/5534984408992" target="_blank" class="block w-full text-center bg-brand-gold text-black font-bold py-4 rounded-lg mb-8 uppercase text-[11px] tracking-widest shadow-lg">
                Anunciar Imóvel
            </a>
            <nav class="flex flex-col gap-6 font-display text-lg font-bold text-white">
                <button onclick="app.router('home'); toggleMobileMenu()" class="text-left flex items-center gap-4"><i data-lucide="home" class="w-5 h-5 text-brand-gold"></i> Início</button>
                <button onclick="app.router('catalog'); toggleMobileMenu()" class="text-left flex items-center gap-4"><i data-lucide="search" class="w-5 h-5 text-brand-gold"></i> Buscar</button>
                <button onclick="app.router('about'); toggleMobileMenu()" class="text-left flex items-center gap-4"><i data-lucide="info" class="w-5 h-5 text-brand-gold"></i> Sobre</button>
            </nav>
        </div>
    </div>

    <main id="app-container" class="min-h-screen relative z-10"></main>

    <div id="sticky-bar-container"></div>

    <footer class="bg-[#020203] border-t border-brand-border pt-16 pb-6 lg:pb-10 relative z-20">
        <div class="max-w-7xl mx-auto px-6 grid md:grid-cols-3 gap-12 mb-12">
            <div>
                <img src="logo-minas.png" class="h-16 w-auto mb-6 opacity-80" onerror="this.onerror=null; this.src='https://via.placeholder.com/150x60/C6A87C/000000?text=M'">
                <p class="text-gray-500 text-sm leading-relaxed mb-6">Líder em negócios imobiliários em Uberaba e região. Conectando oportunidades rurais e urbanas com segurança jurídica.</p>
                <div class="flex gap-4">
                    <a href="https://instagram.com/minasimoveis.ura" target="_blank" class="p-2 rounded btn-insta shadow-lg transition-all hover:scale-105" title="Siga no Instagram">
                        <i data-lucide="instagram" class="w-5 h-5"></i>
                    </a>
                </div>
            </div>
            <div>
                <h4 class="font-display font-bold text-white text-sm mb-6 uppercase tracking-widest border-b border-brand-gold/30 pb-2 inline-block">Contato</h4>
                <ul class="space-y-4 text-sm text-gray-400">
                    <li class="flex gap-3 items-start"><i data-lucide="map-pin" class="text-brand-gold w-5 h-5 shrink-0 mt-0.5"></i> Av. Frei Paulino, 288 - Abadia, Uberaba-MG</li>
                    <li class="flex gap-3 items-center"><i data-lucide="phone" class="text-brand-gold w-5 h-5 shrink-0"></i> (34) 98440-8992</li>
                    <li class="flex gap-3 items-center"><i data-lucide="mail" class="text-brand-gold w-5 h-5 shrink-0"></i> contato@minasimoveis.com.br</li>
                </ul>
            </div>
            <div class="h-48 rounded-lg overflow-hidden border border-brand-border bg-gray-900 transition-all">
                <iframe src="https://maps.google.com/maps?q=Av.+Frei+Paulino,+288+-+Abadia,+Uberaba+-+MG&t=&z=17&ie=UTF8&iwloc=&output=embed" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy"></iframe>
            </div>
        </div>
        
        <div class="text-center pt-6 border-t border-white/5 pb-4 lg:pb-0">
            <p class="text-gray-600 text-[9px] uppercase tracking-[0.2em] transform scale-y-75 origin-bottom opacity-60">
                © 2026 Minas Imóveis. Todos os direitos reservados.
            </p>
        </div>
    </footer>

    <script>
        // --- DADOS FIXOS PARA A APRESENTAÇÃO (DEMO) ---
        // Fotos de Unsplash (Alta qualidade, estilo profissional)
        const demoData = [
            {
                id: 101,
                title: "Mansão Neoclássica no Damha I",
                location: "Damha I, Uberaba - MG",
                price: 3500000,
                image: "https://images.unsplash.com/photo-1613490493576-7fde63acd811?q=80&w=1600&auto=format&fit=crop",
                gallery: [
                    "https://images.unsplash.com/photo-1613490493576-7fde63acd811?q=80&w=1600&auto=format&fit=crop",
                    "https://images.unsplash.com/photo-1584622050111-993a426fbf0a?q=80&w=1600&auto=format&fit=crop"
                ],
                beds: 4,
                baths: 5,
                garage: 4,
                area: 450,
                type: "Casa",
                purpose: "Comprar",
                description: "Residência espetacular de alto padrão. Possui área de lazer completa, piscina aquecida, espaço gourmet integrado e automação residencial em todos os ambientes."
            },
            {
                id: 102,
                title: "Apartamento Vista Panorâmica",
                location: "Centro, Uberaba - MG",
                price: 850000,
                image: "https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?q=80&w=1600&auto=format&fit=crop",
                gallery: ["https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?q=80&w=1600&auto=format&fit=crop"],
                beds: 3,
                baths: 3,
                garage: 2,
                area: 120,
                type: "Apartamento",
                purpose: "Comprar",
                description: "Apartamento moderno em andar alto com vista definitiva. Sala ampla para 2 ambientes, varanda gourmet envidraçada e cozinha planejada."
            },
            {
                id: 103,
                title: "Fazenda Produtiva na Região",
                location: "Zona Rural, Uberaba - MG",
                price: 12500000,
                image: "https://images.unsplash.com/photo-1500382017468-9049fed747ef?q=80&w=1600&auto=format&fit=crop",
                gallery: ["https://images.unsplash.com/photo-1500382017468-9049fed747ef?q=80&w=1600&auto=format&fit=crop"],
                beds: 5,
                baths: 4,
                garage: 10,
                area: 450000, 
                type: "Fazenda",
                purpose: "Comprar",
                description: "Excelente oportunidade para agronegócio. Terra de cultura, rica em água com nascentes e represa. Casa sede centenária reformada."
            },
            {
                id: 104,
                title: "Casa Moderna para Locação",
                location: "Parque do Mirante, Uberaba - MG",
                price: 4500.00, 
                image: "https://images.unsplash.com/photo-1600596542815-e495e91f62b8?q=80&w=1600&auto=format&fit=crop",
                gallery: ["https://images.unsplash.com/photo-1600596542815-e495e91f62b8?q=80&w=1600&auto=format&fit=crop"],
                beds: 3,
                baths: 2,
                garage: 2,
                area: 180,
                type: "Casa",
                purpose: "Alugar",
                description: "Casa térrea recém construída disponível para locação. Design moderno, ambientes integrados e muita iluminação natural."
            },
            {
                id: 105,
                title: "Flat Mobiliado Universitário",
                location: "Universitário, Uberaba - MG",
                price: 1800.00, 
                image: "https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?q=80&w=1600&auto=format&fit=crop",
                gallery: ["https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?q=80&w=1600&auto=format&fit=crop"],
                beds: 1,
                baths: 1,
                garage: 1,
                area: 45,
                type: "Apartamento",
                purpose: "Alugar",
                description: "Flat completo, mobiliado, ideal para estudantes. Próximo à universidade e comércios."
            },
            {
                id: 106,
                title: "Terreno em Condomínio Fechado",
                location: "EcoPark, Uberaba - MG",
                price: 250000, 
                image: "https://images.unsplash.com/photo-1500076656116-558758c991c1?q=80&w=1600&auto=format&fit=crop",
                gallery: ["https://images.unsplash.com/photo-1500076656116-558758c991c1?q=80&w=1600&auto=format&fit=crop"],
                beds: 0,
                baths: 0,
                garage: 0,
                area: 1000,
                type: "Terreno",
                purpose: "Comprar",
                description: "Lote plano em condomínio de luxo. Ótima topografia e localização privilegiada dentro do empreendimento."
            }
        ];

        // 1. Tenta carregar do LocalStorage
        const localData = JSON.parse(localStorage.getItem('minas_imoveis_data') || '[]');
        
        // 2. Se o localStorage estiver vazio (como na Vercel para cliente novo), usa os dados Demo.
        // Se você tiver adicionado algo no seu PC, ele vai usar o seu.
        const properties = (localData && localData.length > 0) ? localData : demoData;

        // 3. Calcula Minimo e Máximo REAIS baseados nos dados carregados
        const allPrices = properties.map(p => Number(p.price));
        const realMin = allPrices.length ? Math.min(...allPrices) : 0;
        const realMax = allPrices.length ? Math.max(...allPrices) : 10000000;

        const state = { 
            view: 'home', 
            properties, 
            filteredProperties: properties, 
            // Inicializa os filtros com os valores Min/Max corretos dos dados
            filters: { type: 'all', purpose: 'all', search: '', minPrice: realMin, maxPrice: realMax, beds: 0, baths: 0, garage: 0 },
            isMobileFiltersOpen: false,
            datasetMin: realMin, 
            datasetMax: realMax, 
            selectedProperty: null, 
            currentImageIndex: 0
        };

        const formatCurrency = (v) => new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL', maximumFractionDigits: 0 }).format(v);
        const formatNumber = (v) => new Intl.NumberFormat('pt-BR').format(v);

        const generateWatermarkGrid = () => {
            const grid = document.getElementById('watermark-grid');
            if(!grid) return;
            let html = '';
            for(let i=0; i<50; i++) html += `<div class="watermark-item">Minas Imóveis • Não Copie</div>`;
            grid.innerHTML = html;
        };
        window.addEventListener('resize', generateWatermarkGrid);

        const createCard = (p) => `
            <div class="bg-[#121826] border border-white/5 rounded-xl overflow-hidden cursor-pointer flex flex-col shadow-lg active:scale-[0.98] transition-transform duration-200" onclick="app.showDetails(${p.id})">
                <div class="relative h-60 bg-black">
                    <img src="${p.image}" class="w-full h-full object-cover" loading="lazy">
                    <div class="absolute inset-0 bg-gradient-to-t from-[#121826] to-transparent opacity-80"></div>
                    <div class="img-watermark">MINAS IMÓVEIS</div>
                    <div class="absolute top-3 left-3"><span class="bg-brand-gold text-black text-[9px] font-bold px-2 py-1 rounded-sm uppercase tracking-widest shadow-md">${p.purpose}</span></div>
                    <div class="absolute bottom-3 left-4 right-4">
                        <span class="text-brand-gold text-[9px] font-bold uppercase tracking-widest block font-display">${p.type}</span>
                        <p class="text-white text-xl font-bold font-display tracking-tight">${formatCurrency(p.price)}</p>
                    </div>
                </div>
                <div class="p-4 flex flex-col flex-grow">
                    <h3 class="text-gray-100 font-bold text-base mb-1 line-clamp-1">${p.title}</h3>
                    <p class="text-gray-500 text-xs mb-4 flex items-center gap-1 line-clamp-1"><i data-lucide="map-pin" class="w-3 h-3 text-brand-gold"></i> ${p.location}</p>
                    <div class="mt-auto pt-3 border-t border-white/5 grid grid-cols-4 gap-1 text-gray-400 text-[10px] font-bold uppercase text-center">
                        ${p.type!=='Terreno' && p.type!=='Galpão' ? `
                            <div class="flex flex-col items-center"><i data-lucide="bed-double" class="w-3.5 h-3.5 mb-1 text-brand-gold"></i>${p.beds}</div>
                            <div class="flex flex-col items-center"><i data-lucide="shower-head" class="w-3.5 h-3.5 mb-1 text-brand-gold"></i>${p.baths}</div>
                        ` : '<div class="col-span-2"></div>'}
                        <div class="flex flex-col items-center"><i data-lucide="car" class="w-3.5 h-3.5 mb-1 text-brand-gold"></i>${p.garage}</div>
                        <div class="flex flex-col items-center"><i data-lucide="ruler" class="w-3.5 h-3.5 mb-1 text-brand-gold"></i>${formatNumber(p.area)}</div>
                    </div>
                </div>
            </div>
        `;

        const views = {
            home: () => `
                <section class="min-h-[100vh] flex flex-col justify-center items-center px-6 text-center relative overflow-hidden pb-20">
                    <div class="absolute inset-0 z-0"><img src="https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?q=80&w=1000&auto=format&fit=crop" class="w-full h-full object-cover opacity-20"><div class="absolute inset-0 bg-gradient-to-b from-[#050608] via-transparent to-[#050608]"></div></div>
                    <div class="relative z-10 w-full max-w-2xl fade-in mt-10 lg:mt-0">
                        <div class="flex justify-center mb-6 lg:hidden">
                            <img src="logo-minas.png" alt="Minas Imóveis" class="h-40 w-auto object-contain drop-shadow-2xl">
                        </div>
                        <h1 class="text-3xl md:text-5xl lg:text-6xl font-display font-black text-white mb-8 leading-tight tracking-tight">
                            Soluções completas para você<br>
                            <span class="text-transparent bg-clip-text bg-gradient-to-r from-brand-gold to-[#fdf497]">realizar seus sonhos!</span>
                        </h1>
                        <div class="glass-panel p-3 rounded-xl shadow-2xl border border-brand-gold/20 flex flex-col gap-3 max-w-lg mx-auto">
                            <div class="flex items-center bg-[#0c101a] rounded-lg px-4 border border-white/10">
                                <i data-lucide="search" class="text-brand-gold w-5 h-5 mr-3"></i>
                                <input type="text" placeholder="Buscar por bairro..." class="bg-transparent w-full text-white h-12 outline-none text-sm placeholder-gray-500" oninput="app.updateSearch(this.value)">
                            </div>
                            <button onclick="app.router('catalog')" class="w-full bg-brand-gold text-black font-bold h-12 rounded-lg uppercase text-xs tracking-widest shadow-lg hover:bg-white transition-colors">Ver Imóveis</button>
                        </div>
                    </div>
                </section>
                <section class="px-6 pb-20 max-w-7xl mx-auto">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-lg font-bold text-white font-display">Destaques</h2>
                        <button onclick="app.router('catalog')" class="text-brand-gold text-xs font-bold uppercase">Ver Mais</button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                         ${state.properties.slice(0, 3).map(createCard).join('')}
                    </div>
                </section>
            `,
            catalog: () => {
                const isFiltersOpen = state.isMobileFiltersOpen ? 'block' : 'hidden lg:block';
                const toggleText = state.isMobileFiltersOpen ? 'Ocultar Filtros' : 'Filtrar Busca';
                
                return `
                <div class="flex flex-col lg:flex-row pt-20 lg:pt-28 min-h-screen">
                    <div class="lg:hidden px-6 mb-4">
                        <button onclick="app.toggleFilters()" class="w-full bg-[#121826] border border-brand-gold/30 text-white py-3 rounded-lg flex items-center justify-center gap-3 text-xs font-bold uppercase tracking-widest shadow-lg active:scale-95 transition-transform">
                            <i data-lucide="filter" class="w-4 h-4 text-brand-gold"></i> ${toggleText}
                        </button>
                    </div>

                    <aside class="w-full lg:w-80 bg-[#080A12] lg:border-r border-brand-border px-6 pb-6 lg:h-[calc(100vh-7rem)] lg:sticky lg:top-28 overflow-y-auto ${isFiltersOpen} fade-in custom-scrollbar">
                        <div class="space-y-3 pt-2">
                             <div>
                                <label class="text-[9px] text-gray-400 uppercase font-bold mb-1 block">Busca</label>
                                <input id="filter-search" type="text" class="input-padrao" value="${state.filters.search}" oninput="app.setFilter('search', this.value)" placeholder="Cidade ou Bairro">
                            </div>
                            <div class="grid grid-cols-2 gap-2">
                                <button id="btn-buy" onclick="app.setFilter('purpose', 'comprar')" class="h-10 text-[10px] font-bold uppercase rounded-lg border transition-all ${state.filters.purpose==='comprar'?'bg-brand-gold text-black border-brand-gold':'border-white/10 text-gray-400'}">Comprar</button>
                                <button id="btn-rent" onclick="app.setFilter('purpose', 'alugar')" class="h-10 text-[10px] font-bold uppercase rounded-lg border transition-all ${state.filters.purpose==='alugar'?'bg-brand-gold text-black border-brand-gold':'border-white/10 text-gray-400'}">Alugar</button>
                            </div>
                            <div>
                                <label class="text-[9px] text-gray-400 uppercase font-bold mb-1 block">Tipo</label>
                                <select id="filter-type" onchange="app.setFilter('type', this.value)" class="input-padrao">
                                    <option value="all" ${state.filters.type === 'all' ? 'selected' : ''}>Todos</option>
                                    <option value="Casa" ${state.filters.type === 'Casa' ? 'selected' : ''}>Casa</option>
                                    <option value="Apartamento" ${state.filters.type === 'Apartamento' ? 'selected' : ''}>Apartamento</option>
                                    <option value="Fazenda" ${state.filters.type === 'Fazenda' ? 'selected' : ''}>Fazenda</option>
                                    <option value="Terreno" ${state.filters.type === 'Terreno' ? 'selected' : ''}>Terreno</option>
                                </select>
                            </div>
                            <div class="grid grid-cols-3 gap-2 border-t border-white/10 pt-3">
                                <div><label class="text-[9px] text-gray-500 text-center block mb-1 font-bold uppercase flex items-center justify-center gap-1"><i data-lucide="bed-double" class="w-3 h-3 text-brand-gold"></i> Qtos</label><select id="filter-beds" onchange="app.setFilter('beds', Number(this.value))" class="input-padrao text-center px-1"><option value="0" ${state.filters.beds == 0 ? 'selected' : ''}>-</option><option value="1" ${state.filters.beds == 1 ? 'selected' : ''}>1+</option><option value="2" ${state.filters.beds == 2 ? 'selected' : ''}>2+</option><option value="3" ${state.filters.beds == 3 ? 'selected' : ''}>3+</option><option value="4" ${state.filters.beds == 4 ? 'selected' : ''}>4+</option></select></div>
                                <div><label class="text-[9px] text-gray-500 text-center block mb-1 font-bold uppercase flex items-center justify-center gap-1"><i data-lucide="shower-head" class="w-3 h-3 text-brand-gold"></i> Ban</label><select id="filter-baths" onchange="app.setFilter('baths', Number(this.value))" class="input-padrao text-center px-1"><option value="0" ${state.filters.baths == 0 ? 'selected' : ''}>-</option><option value="1" ${state.filters.baths == 1 ? 'selected' : ''}>1+</option><option value="2" ${state.filters.baths == 2 ? 'selected' : ''}>2+</option><option value="3" ${state.filters.baths == 3 ? 'selected' : ''}>3+</option></select></div>
                                <div><label class="text-[9px] text-gray-500 text-center block mb-1 font-bold uppercase flex items-center justify-center gap-1"><i data-lucide="car" class="w-3 h-3 text-brand-gold"></i> Vag</label><select id="filter-garage" onchange="app.setFilter('garage', Number(this.value))" class="input-padrao text-center px-1"><option value="0" ${state.filters.garage == 0 ? 'selected' : ''}>-</option><option value="1" ${state.filters.garage == 1 ? 'selected' : ''}>1+</option><option value="2" ${state.filters.garage == 2 ? 'selected' : ''}>2+</option><option value="3" ${state.filters.garage == 3 ? 'selected' : ''}>3+</option></select></div>
                            </div>
                            <div>
                                <label class="text-[9px] text-gray-400 uppercase font-bold mb-2 flex justify-between tracking-widest mt-1"><span>Preço (R$)</span></label>
                                <div class="flex gap-2">
                                    <div class="w-1/2"><input id="filter-min" type="number" class="input-padrao text-center" value="${state.filters.minPrice}" onchange="app.setFilter('minPrice', Number(this.value))" placeholder="Min"></div>
                                    <div class="w-1/2"><input id="filter-max" type="number" class="input-padrao text-center" value="${state.filters.maxPrice}" onchange="app.setFilter('maxPrice', Number(this.value))" placeholder="Max"></div>
                                </div>
                            </div>
                            <button onclick="app.resetFilters()" class="w-full border border-white/10 text-gray-400 py-2.5 rounded-lg text-[10px] uppercase hover:bg-white/5 mt-2 transition-colors">Limpar Filtros</button>
                        </div>
                    </aside>
                    <div class="flex-1 px-6 pb-20 bg-[#050608]">
                        <div class="flex justify-between items-center mb-6 border-b border-white/10 pb-4">
                            <h2 id="results-count" class="text-sm font-bold text-white uppercase tracking-widest">${state.filteredProperties.length} Resultados</h2>
                        </div>
                        <div id="results-grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
                            ${state.filteredProperties.length===0 ? `<div class="text-center py-20 opacity-50 col-span-full"><p class="text-gray-400 text-sm">Sem resultados.</p></div>` : state.filteredProperties.map(createCard).join('')}
                        </div>
                    </div>
                </div>`;
            },
            details: () => {
                const p = state.selectedProperty; 
                if(!p) return app.router('catalog');
                
                const photos = p.gallery && p.gallery.length > 0 ? p.gallery : [p.image];
                const featuresList = Array.isArray(p.features) ? p.features.map(f => typeof f === 'string' ? {icon: 'check', text: f} : f) : [];
                
                setTimeout(() => {
                    document.getElementById('sticky-bar-container').innerHTML = `
                        <div class="mobile-sticky-bar lg:hidden visible flex items-center gap-4">
                            <div class="flex-1">
                                <p class="text-[10px] text-gray-400 uppercase font-bold">Investimento</p>
                                <p class="text-xl font-bold text-white">${formatCurrency(p.price)}</p>
                            </div>
                            <a href="https://wa.me/5534984408992?text=Olá, tenho interesse no imóvel: ${p.title} (Cód: ${p.id})" target="_blank" class="bg-[#25D366] text-white font-bold px-6 py-3 rounded-lg shadow-lg flex items-center gap-2 text-sm hover:bg-green-600 transition-colors">
                                <svg class="w-5 h-5 fill-white" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.008-.57-.008-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
                                        Chamar no WhatsApp
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
                }, 100);

                return `
                <div class="fade-in pb-32 lg:pb-20 lg:pt-24">
                    <div class="bg-black relative">
                        <div class="relative h-[45vh] lg:h-[65vh] w-full group">
                            <img id="main-gallery-image" src="${photos[0]}" class="w-full h-full object-contain transition-opacity duration-300">
                            <div class="img-watermark">MINAS IMÓVEIS</div>
                             ${photos.length > 1 ? `
                            <button onclick="app.changeImage(-1)" class="absolute top-1/2 left-4 -translate-y-1/2 bg-black/40 text-white p-3 rounded-full backdrop-blur active:scale-90 border border-white/10"><i data-lucide="chevron-left" class="w-6 h-6"></i></button>
                            <button onclick="app.changeImage(1)" class="absolute top-1/2 right-4 -translate-y-1/2 bg-black/40 text-white p-3 rounded-full backdrop-blur active:scale-90 border border-white/10"><i data-lucide="chevron-right" class="w-6 h-6"></i></button>
                            ` : ''}
                            <button onclick="app.router('catalog')" class="absolute top-4 left-4 bg-black/50 text-white px-4 py-2 rounded-full flex items-center gap-2 text-[10px] font-bold uppercase backdrop-blur border border-white/10"><i data-lucide="arrow-left" class="w-3 h-3"></i> Voltar</button>
                        </div>
                        ${photos.length > 1 ? `
                        <div class="w-full px-4 py-4 bg-[#080A12] border-b border-white/5">
                            <div class="flex gap-3 overflow-x-auto no-scrollbar snap-x">
                                ${photos.map((img, i) => `
                                    <button onclick="app.selectImage(${i})" class="gallery-thumb flex-shrink-0 w-20 h-16 rounded overflow-hidden bg-gray-900 relative snap-center ${i===0 ? 'active' : ''}"><img src="${img}" class="w-full h-full object-cover"></button>
                                `).join('')}
                            </div>
                            <p class="text-center text-[9px] text-gray-500 mt-2 font-bold uppercase"><span id="counter-display">1</span> / ${photos.length}</p>
                        </div>` : ''}
                    </div>
                    <div class="max-w-6xl mx-auto px-5 lg:px-8 mt-8">
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-10">
                            <div class="lg:col-span-2 space-y-8">
                                <div>
                                    <span class="bg-brand-gold/10 text-brand-gold text-[10px] font-bold px-3 py-1 rounded inline-block mb-3 uppercase tracking-widest">${p.type} • ${p.purpose}</span>
                                    <h1 class="text-2xl lg:text-4xl font-display font-black text-white leading-tight mb-2">${p.title}</h1>
                                    <p class="text-gray-400 text-sm flex items-center gap-2"><i data-lucide="map-pin" class="w-4 h-4 text-brand-gold"></i> ${p.location}</p>
                                </div>
                                <div class="grid grid-cols-4 gap-2 bg-[#121826] p-4 rounded-xl border border-white/5">
                                    <div class="text-center"><span class="block text-lg font-bold text-white">${p.beds}</span><span class="text-[9px] text-gray-500 uppercase font-bold">Qtos</span></div>
                                    <div class="text-center"><span class="block text-lg font-bold text-white">${p.baths}</span><span class="text-[9px] text-gray-500 uppercase font-bold">Ban</span></div>
                                    <div class="text-center"><span class="block text-lg font-bold text-white">${p.garage}</span><span class="text-[9px] text-gray-500 uppercase font-bold">Vagas</span></div>
                                    <div class="text-center"><span class="block text-lg font-bold text-white truncate">${formatNumber(p.area)}</span><span class="text-[9px] text-gray-500 uppercase font-bold">M²</span></div>
                                </div>
                                ${featuresList.length ? `
                                <div>
                                    <h3 class="text-xs font-bold text-white uppercase tracking-widest mb-4 flex items-center gap-2"><span class="w-4 h-px bg-brand-gold"></span> Detalhes</h3>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                                        ${featuresList.map(f => `<div class="flex items-center gap-3 bg-[#121826] p-3 rounded border border-white/5"><i data-lucide="${f.icon||'check'}" class="w-4 h-4 text-brand-gold"></i><span class="text-gray-300 text-sm">${f.text}</span></div>`).join('')}
                                    </div>
                                </div>` : ''}
                                <div>
                                    <h3 class="text-xs font-bold text-white uppercase tracking-widest mb-4">Sobre</h3>
                                    <p class="text-gray-400 text-sm leading-relaxed whitespace-pre-line text-justify">${p.description}</p>
                                </div>
                            </div>
                            <div class="hidden lg:block lg:col-span-1">
                                <div class="glass-panel p-8 rounded-xl sticky top-32 border border-brand-gold/10">
                                    <p class="text-xs text-gray-400 uppercase font-bold mb-1">Valor Total</p>
                                    <p class="text-4xl font-black text-white mb-6">${formatCurrency(p.price)}</p>
                                    <a href="https://wa.me/5534984408992?text=Olá, interesse no imóvel ${p.title} (Cód: ${p.id})" target="_blank" class="w-full bg-[#25D366] hover:bg-green-600 text-white font-bold py-4 rounded-lg flex items-center justify-center gap-2 uppercase text-xs tracking-widest shadow-lg transition-transform hover:-translate-y-1">
                                        <svg class="w-5 h-5 fill-white" viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.008-.57-.008-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/></svg>
                                        Chamar no WhatsApp
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>`;
            },
            about: () => `<div class="pt-32 max-w-4xl mx-auto px-6 text-center fade-in pb-20"><h1 class="text-3xl font-display font-bold text-white mb-6">Sobre Nós</h1><div class="bg-[#121826] p-8 rounded-xl text-gray-300 border border-white/5"><p>Referência em negócios imobiliários.</p></div></div>`
        };

        const app = {
            init: () => { 
                app.router('home'); 
                lucide.createIcons();
                generateWatermarkGrid(); 
            },
            router: (v) => { 
                state.view=v; window.scrollTo(0,0); 
                document.getElementById('sticky-bar-container').innerHTML = ''; 
                document.getElementById('app-container').innerHTML = views[v]?views[v]():views['home'](); 
                lucide.createIcons();
            },
            showDetails: (id) => { const p = state.properties.find(x=>x.id===id); if(p){ state.selectedProperty=p; state.currentImageIndex = 0; app.router('details'); } },
            toggleFilters: () => { state.isMobileFiltersOpen = !state.isMobileFiltersOpen; app.router('catalog'); }, 
            
            updateCatalogResults: () => {
                const grid = document.getElementById('results-grid');
                const count = document.getElementById('results-count');
                if(grid && count) {
                    count.innerText = `${state.filteredProperties.length} Resultados`;
                    grid.innerHTML = state.filteredProperties.length === 0
                        ? `<div class="text-center py-20 opacity-50 col-span-full"><p class="text-gray-400 text-sm">Sem resultados.</p></div>`
                        : state.filteredProperties.map(createCard).join('');
                    lucide.createIcons();
                }
            },

            updatePurposeButtons: (val) => {
                const btnBuy = document.getElementById('btn-buy');
                const btnRent = document.getElementById('btn-rent');
                if(!btnBuy || !btnRent) return;

                const active = "bg-brand-gold text-black border-brand-gold";
                const inactive = "border-white/10 text-gray-400";
                const base = "h-10 text-[10px] font-bold uppercase rounded-lg border transition-all";

                if (val === 'comprar') {
                    btnBuy.className = `${base} ${active}`;
                    btnRent.className = `${base} ${inactive}`;
                } else {
                    btnBuy.className = `${base} ${inactive}`;
                    btnRent.className = `${base} ${active}`;
                }
            },

            setFilter: (k,v) => { 
                if (k === 'minPrice' || k === 'maxPrice' || k === 'beds' || k === 'baths' || k === 'garage') {
                    // Ajuste de segurança: Se vier vazio, usa os limites do dataset
                    const numV = Number(v);
                    if (k === 'minPrice') state.filters.minPrice = v ? numV : state.datasetMin;
                    else if (k === 'maxPrice') state.filters.maxPrice = v ? numV : state.datasetMax;
                    else state.filters[k] = numV; // beds, baths, garage
                } else {
                    state.filters[k] = v;
                }
                
                if (k === 'purpose') app.updatePurposeButtons(v);

                app.applyFilters(); 
            },
            
            resetFilters: () => {
                state.filters = {type:'all', purpose:'all', search:'', minPrice: state.datasetMin, maxPrice: state.datasetMax, beds:0, baths:0, garage:0};
                
                const setVal = (id, v) => { const el = document.getElementById(id); if(el) el.value = v; };
                setVal('filter-search', '');
                setVal('filter-min', state.datasetMin); // Reseta para o minimo real
                setVal('filter-max', state.datasetMax); // Reseta para o maximo real
                setVal('filter-type', 'all');
                setVal('filter-beds', '0');
                setVal('filter-baths', '0');
                setVal('filter-garage', '0');
                
                const btnBuy = document.getElementById('btn-buy');
                const btnRent = document.getElementById('btn-rent');
                const inactive = "border-white/10 text-gray-400";
                const base = "h-10 text-[10px] font-bold uppercase rounded-lg border transition-all";
                if(btnBuy) btnBuy.className = `${base} ${inactive}`;
                if(btnRent) btnRent.className = `${base} ${inactive}`;
                
                app.applyFilters();
            },
            
            applyFilters: () => { 
                let r=state.properties, f=state.filters; 
                if(f.purpose!=='all') r=r.filter(p=>p.purpose.toLowerCase()===f.purpose.toLowerCase()); 
                if(f.type!=='all') r=r.filter(p=>p.type===f.type); 
                
                // Filtro de Preço Robusto
                r=r.filter(p=>Number(p.price)>=f.minPrice && Number(p.price)<=f.maxPrice); 
                
                // Filtros Numéricos (Quarto, Banheiro, Vaga)
                if(f.beds>0) r=r.filter(p=>Number(p.beds)>=f.beds); 
                if(f.baths>0) r=r.filter(p=>Number(p.baths)>=f.baths); 
                if(f.garage>0) r=r.filter(p=>Number(p.garage)>=f.garage); 
                
                // Busca por Texto (Título ou Localização)
                if(f.search) r=r.filter(p=>p.title.toLowerCase().includes(f.search.toLowerCase())||p.location.toLowerCase().includes(f.search.toLowerCase())); 
                
                state.filteredProperties=r; 
                
                if(state.view==='catalog') {
                    app.updateCatalogResults();
                } else {
                    app.router('catalog');
                }
            },
            changeImage: (d) => {
                const p = state.selectedProperty; const photos = p.gallery||[p.image];
                state.currentImageIndex = (state.currentImageIndex + d + photos.length) % photos.length;
                app.updateGalleryUI();
            },
            selectImage: (i) => { state.currentImageIndex = i; app.updateGalleryUI(); },
            updateGalleryUI: () => {
                 const p = state.selectedProperty; const photos = p.gallery||[p.image];
                 document.getElementById('main-gallery-image').src = photos[state.currentImageIndex];
                 if(document.getElementById('counter-display')) document.getElementById('counter-display').innerText = state.currentImageIndex+1;
                 document.querySelectorAll('.gallery-thumb').forEach((el,i) => i===state.currentImageIndex ? el.classList.add('active') : el.classList.remove('active'));
            },
            updateSearch: (v) => { state.filters.search=v; if(state.view==='home'&&v.length>2){ app.setFilter('search',v); app.router('catalog'); }}
        };

        const toggleMobileMenu = () => { 
            const o=document.getElementById('mobile-menu-overlay'), d=document.getElementById('mobile-menu-drawer'); 
            if(o.classList.contains('hidden')){o.classList.remove('hidden'); setTimeout(()=>o.classList.remove('opacity-0'),10); setTimeout(()=>d.classList.add('open'),10)}
            else{d.classList.remove('open'); o.classList.add('opacity-0'); setTimeout(()=>o.classList.add('hidden'),300)}
        };
        
        document.addEventListener('DOMContentLoaded', app.init);
    </script>
</body>
</html>